import unittest
import digest

class TestDigest(unittest.TestCase):
	"""Compare test key and message from RFC2104 with CyberChef output."""
	def test_hmac_sha256(self):
		key = 16*b'\x0b'
		message = 'Hi There'
		h = digest.hmac_sha256(key, message.encode('utf-8'))
		self.assertEqual(h, b'\x49\x2c\xe0\x20\xfe\x25\x34\xa5\x78\x9d\xc3\x84\x88\x06\xc7\x8f\x4f\x67\x11\x39\x7f\x08\xe7\xe7\xa1\x2c\xa5\xa4\x48\x3c\x8a\xa6')

		key = b'Jefe'
		message = 'what do ya want for nothing?'
		h = digest.hmac_sha256(key, message.encode('utf-8'))
		self.assertEqual(h, b'\x5b\xdc\xc1\x46\xbf\x60\x75\x4e\x6a\x04\x24\x26\x08\x95\x75\xc7\x5a\x00\x3f\x08\x9d\x27\x39\x83\x9d\xec\x58\xb9\x64\xec\x38\x43')

		key = 16* b'\xAA'
		message = 50 * b'\xDD'
		h = digest.hmac_sha256(key, message)
		self.assertEqual(h, b'\x7d\xda\x3c\xc1\x69\x74\x3a\x64\x84\x64\x9f\x94\xf0\xed\xa0\xf9\xf2\xff\x49\x6a\x97\x33\xfb\x79\x6e\xd5\xad\xb4\x0a\x44\xc3\xc1')
